<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Interval Trainer</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <!-- Tone.js (synth + sampler engines) -->
  <script type="module" src="synth.js"></script>
  <script type="module" src="app.js"></script>
</head>
<body>
  <header class="topbar">
    <h1>Interval Trainer</h1>
    <button id="open-settings" class="ghost">Settings ⚙️</button>
  </header>

  <main class="container">
    <section class="card-row">
      <div class="card" id="prev-card">
        <div class="card-title">Previous note</div>
        <div class="note-text" id="prev-text">—</div>
        <button id="btn-play-prev" class="secondary" title="P">▶ Play Previous</button>
      </div>

      <div class="card" id="interval-card">
        <div class="card-title">Interval</div>
        <div class="interval-text" id="interval-text">—</div>
      </div>

      <div class="card" id="target-card">
        <div class="card-title">Target note</div>
        <div class="note-text blur" id="target-text">hidden</div>
      </div>
    </section>

    <section class="controls">
      <button id="btn-reveal" class="primary" title="Space">Reveal &amp; Play</button>
      <button id="btn-next" class="secondary" title="N">Next card</button>
      <div class="hint">Shortcuts: <b>Space</b>=reveal/replay, <b>P</b>=play previous, <b>N</b>=next</div>
    </section>
  </main>

  <!-- Settings Modal -->
  <dialog id="settings-dialog">
    <form method="dialog" id="settings-form">
      <h2>Settings</h2>

      <fieldset>
        <legend>Note range</legend>
        <div class="grid2">
          <label>Lowest note
            <input id="range-min" list="note-list" />
          </label>
          <label>Highest note
            <input id="range-max" list="note-list" />
          </label>
        </div>
        <small>Default: A2 – E4 (Baritone Range)</small>
      </fieldset>

      <fieldset>
        <legend>Intervals (pool)</legend>
        <div class="interval-pool" id="interval-pool">
          <!-- Filled by JS -->
        </div>
        <small>Select the intervals to draw from. Direction (↑/↓) is randomized per card.</small>
      </fieldset>

      <fieldset>
        <legend>Display</legend>
        <label class="row">
          <input type="checkbox" id="show-octaves" checked />
          Show octave numbers (e.g., C4). If off: show C#/Db etc. without octaves.
        </label>
      </fieldset>

      <fieldset>
        <legend>Audio engine</legend>
        <label class="row"><input type="radio" name="engine" value="web" /> WebSynth (Oscillator)</label>
        <label class="row"><input type="radio" name="engine" value="tone-synth" checked /> Tone Synth</label>
        <label class="row"><input type="radio" name="engine" value="tone-sampler" /> Tone Sampler (piano)</label>
        <small id="engine-status">Engine: not initialized</small>
      </fieldset>

      <menu>
        <button value="cancel" class="ghost" formmethod="dialog">Cancel</button>
        <button id="save-settings" type="button" class="primary" autofocus>Save</button>
      </menu>
    </form>

    <!-- datalist of common notes for easier typing -->
    <datalist id="note-list">
      <!-- Filled by JS -->
    </datalist>
  </dialog>

  <footer class="footer">
    <span>© Stefan Rickli — Host on GitHub Pages</span>
    <a href="https://tonejs.github.io" target="_blank" rel="noopener">Tone.js</a>
  </footer>
</body>
</html>
